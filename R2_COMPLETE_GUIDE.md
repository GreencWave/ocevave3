# R2 í™œì„±í™” ì™„ì „ ê°€ì´ë“œ

## ğŸ“‹ í˜„ì¬ ìƒíƒœ

âœ… **ì™„ë£Œëœ ì‘ì—…:**
- wrangler.tomlì— R2 ì„¤ì • ì¶”ê°€
- ì´ë¯¸ì§€ ì—…ë¡œë“œ ì½”ë“œì— R2 ì§€ì› ì¶”ê°€ (ìµœëŒ€ 50MB)
- D1 í´ë°± ì‹œìŠ¤í…œ êµ¬í˜„ (R2 ë¯¸ì‚¬ìš© ì‹œ 10MB)
- Cloudflare Pages ë°°í¬ ì™„ë£Œ

âŒ **ì•„ì§ í•„ìš”í•œ ì‘ì—…:**
- Cloudflare Dashboardì—ì„œ R2 í™œì„±í™”
- R2 ë²„í‚· ìƒì„±
- Pagesì— R2 ë°”ì¸ë”© ì¶”ê°€

---

## ğŸš€ R2 í™œì„±í™” ë‹¨ê³„

### 1ë‹¨ê³„: Cloudflare Dashboardì—ì„œ R2 í™œì„±í™” âš¡

**ì¤‘ìš”: ì´ ë‹¨ê³„ëŠ” Dashboardì—ì„œë§Œ ê°€ëŠ¥í•©ë‹ˆë‹¤!**

1. **Dashboard ì ‘ì†**
   ```
   ğŸ‘‰ https://dash.cloudflare.com
   ```

2. **R2 ë©”ë‰´ ì°¾ê¸°**
   - ì™¼ìª½ ì‚¬ì´ë“œë°”ì—ì„œ **"R2"** í´ë¦­
   - ë˜ëŠ” ìƒë‹¨ ê²€ìƒ‰ì°½ì— "R2" ì…ë ¥

3. **R2 í™œì„±í™”**
   - **"Enable R2"** ë˜ëŠ” **"Purchase R2"** ë²„íŠ¼ í´ë¦­
   - ê²°ì œ ì •ë³´ ì…ë ¥/í™•ì¸
     - ì‹ ìš©ì¹´ë“œ ë“±ë¡ í•„ìš” (ë¬´ë£Œ ë²”ìœ„ ì‚¬ìš© ì‹œì—ë„)
     - ì²« 10GB/ì›”: **ë¬´ë£Œ**
     - ì¶”ê°€ ìŠ¤í† ë¦¬ì§€: $0.015/GB/ì›”
   - ì•½ê´€ ë™ì˜
   - **"Enable R2"** ìµœì¢… í™•ì¸

4. **í™œì„±í™” í™•ì¸**
   - R2 ëŒ€ì‹œë³´ë“œê°€ í‘œì‹œë˜ë©´ ì„±ê³µ!
   - "Create bucket" ë²„íŠ¼ì´ ë³´ì´ë©´ í™œì„±í™” ì™„ë£Œ

---

### 2ë‹¨ê³„: R2 ë²„í‚· ìƒì„± ğŸª£

**Dashboardì—ì„œ R2ë¥¼ í™œì„±í™”í•œ í›„** í„°ë¯¸ë„ì—ì„œ ì‹¤í–‰:

```bash
cd /home/user/webapp
npx wrangler r2 bucket create ocevave-images
```

**ì˜ˆìƒ ì¶œë ¥:**
```
âœ¨ Successfully created R2 bucket 'ocevave-images'
```

**ë²„í‚· í™•ì¸:**
```bash
npx wrangler r2 bucket list
```

**ë˜ëŠ” ìë™í™” ìŠ¤í¬ë¦½íŠ¸ ì‚¬ìš©:**
```bash
cd /home/user/webapp
./R2_ACTIVATION_COMMANDS.sh
```

---

### 3ë‹¨ê³„: Cloudflare Pagesì— R2 ë°”ì¸ë”© ì¶”ê°€ ğŸ”—

**ì¤‘ìš”: ì´ ë‹¨ê³„ë¥¼ ê±´ë„ˆë›°ë©´ R2ê°€ ì‘ë™í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤!**

1. **Pages ì„¤ì • ì ‘ì†**
   ```
   https://dash.cloudflare.com
   â†’ Pages
   â†’ ocevave
   â†’ Settings
   â†’ Functions
   ```

2. **R2 Bucket Bindings ì„¹ì…˜ ì°¾ê¸°**
   - í˜ì´ì§€ë¥¼ ì•„ë˜ë¡œ ìŠ¤í¬ë¡¤
   - "R2 Bucket Bindings" ì„¹ì…˜ ì°¾ê¸°

3. **ë°”ì¸ë”© ì¶”ê°€**
   - **"Add binding"** ë²„íŠ¼ í´ë¦­
   - ì…ë ¥:
     - **Variable name:** `R2` (ì •í™•íˆ ëŒ€ë¬¸ì)
     - **R2 bucket:** `ocevave-images` (ë“œë¡­ë‹¤ìš´ì—ì„œ ì„ íƒ)
   - **"Save"** ë²„íŠ¼ í´ë¦­

4. **ë³€ê²½ì‚¬í•­ ì €ì¥ í™•ì¸**
   - "Your changes have been saved" ë©”ì‹œì§€ í™•ì¸

---

### 4ë‹¨ê³„: ì¬ë°°í¬ ğŸš€

**ì˜µì…˜ A: Dashboardì—ì„œ ì¬ë°°í¬ (ê¶Œì¥)**
```
1. Pages â†’ ocevave â†’ Deployments
2. ìµœì‹  ë°°í¬ì—ì„œ "..." í´ë¦­
3. "Retry deployment" í´ë¦­
4. ë°°í¬ ì™„ë£Œ ëŒ€ê¸° (ì•½ 1-2ë¶„)
```

**ì˜µì…˜ B: í„°ë¯¸ë„ì—ì„œ ì¬ë°°í¬**
```bash
cd /home/user/webapp
npm run build
npx wrangler pages deploy dist --project-name ocevave
```

---

### 5ë‹¨ê³„: í…ŒìŠ¤íŠ¸ âœ…

1. **ê´€ë¦¬ì í˜ì´ì§€ ì ‘ì†**
   ```
   https://fabf91b6.ocevave.pages.dev/admin
   
   ì´ë©”ì¼: admin@ocevave
   ë¹„ë°€ë²ˆí˜¸: admin123
   ```

2. **ëŒ€ìš©ëŸ‰ ì´ë¯¸ì§€ ì—…ë¡œë“œ í…ŒìŠ¤íŠ¸**
   - ìƒí’ˆ ì¶”ê°€ ë˜ëŠ” í¸ì§‘
   - ì´ë¯¸ì§€ ì„ íƒ (ìµœëŒ€ 50MB ê°€ëŠ¥)
   - ë¯¸ë¦¬ë³´ê¸° í™•ì¸
   - ì €ì¥ ë²„íŠ¼ í´ë¦­

3. **ì½˜ì†” í™•ì¸ (F12)**
   ```
   âœ… R2 ì„±ê³µ: "Image uploaded successfully"
   âŒ R2 ì‹¤íŒ¨: "R2 not available, using database storage"
   ```

4. **ì´ë¯¸ì§€ ë¡œë”© í™•ì¸**
   - ìƒí’ˆ ëª©ë¡ì—ì„œ ì´ë¯¸ì§€ í‘œì‹œ í™•ì¸
   - Network íƒ­ì—ì„œ ì´ë¯¸ì§€ ìš”ì²­ í™•ì¸
   - 200 OK ì‘ë‹µ í™•ì¸

---

## ğŸ” ë¬¸ì œ í•´ê²°

### ë¬¸ì œ 1: "Error 10042: Please enable R2"

**ì›ì¸:** R2ê°€ ì•„ì§ í™œì„±í™”ë˜ì§€ ì•ŠìŒ

**í•´ê²°:**
1. Dashboard â†’ R2 â†’ Enable R2 í´ë¦­
2. ê²°ì œ ì •ë³´ ì…ë ¥
3. í™œì„±í™” ì™„ë£Œ í›„ ë²„í‚· ìƒì„± ì¬ì‹œë„

---

### ë¬¸ì œ 2: ë²„í‚·ì€ ìƒì„±ë˜ì—ˆì§€ë§Œ ì´ë¯¸ì§€ê°€ R2ì— ì €ì¥ë˜ì§€ ì•ŠìŒ

**ì›ì¸:** Pagesì— R2 ë°”ì¸ë”©ì´ ì¶”ê°€ë˜ì§€ ì•ŠìŒ

**í•´ê²°:**
1. Dashboard â†’ Pages â†’ ocevave â†’ Settings â†’ Functions
2. R2 Bucket Bindings ì„¹ì…˜ í™•ì¸
3. Variable name: `R2`, Bucket: `ocevave-images` ì¶”ê°€
4. Save í›„ ì¬ë°°í¬

**í™•ì¸ ë°©ë²•:**
```bash
# Pages ì„¤ì • í™•ì¸
curl -s -H "Authorization: Bearer $CLOUDFLARE_API_TOKEN" \
  "https://api.cloudflare.com/client/v4/accounts/4eb74611f1b8b6d616ed59df7627b270/pages/projects/ocevave" \
  | grep -A5 "r2_buckets"
```

---

### ë¬¸ì œ 3: ì¬ë°°í¬ í›„ì—ë„ 10MB ì œí•œ

**ì›ì¸:** ë¸Œë¼ìš°ì € ìºì‹œ

**í•´ê²°:**
1. **Ctrl + Shift + Delete** â†’ ìºì‹œ ì‚­ì œ
2. **Ctrl + F5** (í•˜ë“œ ë¦¬ë¡œë“œ)
3. ì‹œí¬ë¦¿ ëª¨ë“œì—ì„œ í…ŒìŠ¤íŠ¸
4. ìµœì‹  ë°°í¬ URL í™•ì¸

---

### ë¬¸ì œ 4: R2 ë°”ì¸ë”© ì¶”ê°€ ì˜µì…˜ì´ ë³´ì´ì§€ ì•ŠìŒ

**ì›ì¸:** R2ê°€ í™œì„±í™”ë˜ì§€ ì•Šì•˜ê±°ë‚˜ ê¶Œí•œ ë¶€ì¡±

**í•´ê²°:**
1. Dashboard â†’ R2 ë©”ë‰´ í™•ì¸
2. R2ê°€ í™œì„±í™”ë˜ì–´ ìˆëŠ”ì§€ í™•ì¸
3. API í† í°ì— R2 Edit ê¶Œí•œ í™•ì¸
4. ê³„ì • ê´€ë¦¬ì ê¶Œí•œ í™•ì¸

---

## ğŸ“Š R2 vs D1 ë¹„êµ

| í•­ëª© | R2 (í™œì„±í™” ì‹œ) | D1 (í´ë°±) |
|------|---------------|-----------|
| ìµœëŒ€ íŒŒì¼ í¬ê¸° | 50MB | 10MB |
| ì €ì¥ ë°©ì‹ | Object Storage | base64 in DB |
| ì†ë„ | ë§¤ìš° ë¹ ë¦„ | ëŠë¦¼ |
| ë¹„ìš© | 10GB ë¬´ë£Œ/ì›” | DB í¬ê¸°ì— í¬í•¨ |
| CDN ìºì‹± | ìë™ | ì§€ì› |
| ê¶Œì¥ ì‚¬ìš©ì²˜ | í”„ë¡œë•ì…˜ | ê°œë°œ/í…ŒìŠ¤íŠ¸ |

---

## ğŸ’° R2 ê°€ê²© ì •ì±…

### ë¬´ë£Œ í‹°ì–´
- **Storage:** ì²« 10GB/ì›” ë¬´ë£Œ
- **Class A (write):** ì²« 100ë§Œ ìš”ì²­/ì›” ë¬´ë£Œ
- **Class B (read):** ì²« 1000ë§Œ ìš”ì²­/ì›” ë¬´ë£Œ
- **Egress (ì™¸ë¶€ ì „ì†¡):** ì™„ì „ ë¬´ë£Œ (AWS S3ì™€ ë‹¤ë¦„)

### ìœ ë£Œ (ì´ˆê³¼ ì‹œ)
- **Storage:** $0.015/GB/ì›” (AWS S3ì˜ 70% ì €ë ´)
- **Class A:** $4.50/ë°±ë§Œ ìš”ì²­
- **Class B:** $0.36/ë°±ë§Œ ìš”ì²­

### ì˜ˆìƒ ë¹„ìš© (ì›”ê°„)
- **ì†Œê·œëª¨ ì‚¬ì´íŠ¸ (1,000ëª… ë°©ë¬¸ì):** $0 (ë¬´ë£Œ ë²”ìœ„)
- **ì¤‘ê·œëª¨ ì‚¬ì´íŠ¸ (10,000ëª… ë°©ë¬¸ì):** $0-5
- **ëŒ€ê·œëª¨ ì‚¬ì´íŠ¸ (100,000ëª… ë°©ë¬¸ì):** $10-30

---

## ğŸ“Œ ìš”ì•½ ì²´í¬ë¦¬ìŠ¤íŠ¸

- [ ] 1. Cloudflare Dashboardì—ì„œ R2 í™œì„±í™”
- [ ] 2. í„°ë¯¸ë„ì—ì„œ `npx wrangler r2 bucket create ocevave-images` ì‹¤í–‰
- [ ] 3. Pages â†’ Settings â†’ Functions â†’ R2 Bucket Bindings ì¶”ê°€
- [ ] 4. Variable name: `R2`, Bucket: `ocevave-images`
- [ ] 5. Save í›„ Retry deployment
- [ ] 6. í…ŒìŠ¤íŠ¸: 50MB ì´ë¯¸ì§€ ì—…ë¡œë“œ
- [ ] 7. ì½˜ì†”/Network íƒ­ì—ì„œ í™•ì¸

---

## ğŸ”— ì°¸ê³  ë§í¬

- **Cloudflare Dashboard:** https://dash.cloudflare.com
- **R2 ë¬¸ì„œ:** https://developers.cloudflare.com/r2/
- **Pages ì„¤ì •:** https://dash.cloudflare.com/pages/view/ocevave/settings/functions
- **í”„ë¡œë•ì…˜ ì‚¬ì´íŠ¸:** https://fabf91b6.ocevave.pages.dev
- **GitHub ì €ì¥ì†Œ:** https://github.com/GreencWave/ocevave3

---

## ğŸ†˜ ì¶”ê°€ ë„ì›€ì´ í•„ìš”í•˜ì‹ ê°€ìš”?

1. **R2_SETUP_GUIDE.md** - ê¸°ë³¸ ì„¤ì • ê°€ì´ë“œ
2. **IMAGE_UPLOAD_TROUBLESHOOTING.md** - ë¬¸ì œ í•´ê²° ê°€ì´ë“œ
3. **R2_ACTIVATION_COMMANDS.sh** - ìë™í™” ìŠ¤í¬ë¦½íŠ¸

**ì§ˆë¬¸ì´ ìˆìœ¼ì‹œë©´:**
- GitHub Issues: https://github.com/GreencWave/ocevave3/issues
- ì½˜ì†” ë¡œê·¸ (F12) ìŠ¤í¬ë¦°ìƒ· ì²¨ë¶€
- ì—ëŸ¬ ë©”ì‹œì§€ ì „ì²´ ë³µì‚¬
